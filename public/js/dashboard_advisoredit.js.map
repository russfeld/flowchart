{"version":3,"sources":["advisoredit.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dashboard_advisoredit.js","sourcesContent":["require(['util/site', 'util/dashboard'], function(site, dashboard) {\n\n  site.ajaxcrsf();\n\n  var options = dashboard.dataTableOptions;\n  options.dom = '<\"newbutton\">frtip';\n  dashboard.init(options);\n  site.checkMessage();\n\n  $(\"div.newbutton\").html('<a type=\"button\" class=\"btn btn-success\" href=\"/admin/newadvisor\">New Advisor</a>');\n\n\n  $('#save').on('click', function(){\n    $('#spin').removeClass('hide-spin');\n    var formData = new FormData($('form')[0]);\n\t\tformData.append(\"name\", $('#name').val());\n\t\tformData.append(\"email\", $('#email').val());\n\t\tformData.append(\"office\", $('#office').val());\n\t\tformData.append(\"phone\", $('#phone').val());\n\t\tformData.append(\"notes\", $('#notes').val());\n    formData.append(\"notes\", $('#notes').val());\n\t\tif($('#pic').val()){\n\t\t\tformData.append(\"pic\", $('#pic')[0].files[0]);\n\t\t}\n    if($('#department').val() > 0){\n      formData.append(\"department\", $('#department').val());\n    }\n    var id = $('#id').val();\n    if(id.length == 0){\n      formData.append(\"eid\", $('#eid').val());\n      var url = '/admin/newadvisor';\n    }else{\n      formData.append(\"eid\", $('#eid').val());\n      var url = '/admin/advisors/' + id;\n    }\n\t\t$.ajax({\n\t\t  method: \"POST\",\n\t\t  url: url,\n\t\t  data: formData,\n\t\t\tdataType: 'json',\n\t\t\tprocessData: false,\n\t\t\tcontentType: false,\n\t\t})\n\t\t.success(function( message ) {\n      if(id.length == 0){\n        site.clearFormErrors();\n        $('#spin').addClass('hide-spin');\n        $(location).attr('href', message);\n      }else{\n  \t\t\tsite.displayMessage(message, \"success\");\n  \t\t\tsite.clearFormErrors();\n  \t\t\t$('#spin').addClass('hide-spin');\n  \t\t\t$.ajax({\n  \t\t\t\tmethod: \"GET\",\n  \t\t\t  url: '/profile/pic/' + id,\n  \t\t\t})\n  \t\t\t.success(function(message){\n  \t\t\t\t$('#pictext').val(message);\n  \t\t\t\t$('#picimg').attr('src', message);\n  \t\t\t});\n      }\n\t\t}).fail(function( jqXHR, message ){\n\t\t\tif (jqXHR.status == 422)\n\t\t\t{\n\t\t\t\tsite.setFormErrors(jqXHR.responseJSON);\n\t\t\t}else{\n\t\t\t\talert(\"Unable to save: \" + jqXHR.responseJSON);\n\t\t\t}\n\t\t\t$('#spin').addClass('hide-spin');\n\t\t});\n  });\n\n  $('#delete').on('click', function(){\n    var choice = confirm(\"Are you sure?\");\n\t\tif(choice === true){\n      $('#spin').removeClass('hide-spin');\n      var data = {\n        id: $('#id').val(),\n      };\n      var url = \"/admin/deleteadvisor\"\n      $.ajax({\n        method: \"POST\",\n        url: url,\n        data: data\n      })\n      .success(function( message ) {\n        $(location).attr('href', '/admin/advisors');\n      })\n      .fail(function( jqXHR, message ){\n        if (jqXHR.status == 422)\n        {\n          site.setFormErrors(jqXHR.responseJSON);\n        }else{\n          alert(\"Unable to delete: \" + jqXHR.responseJSON);\n        }\n        $('#spin').addClass('hide-spin');\n      });\n    }\n  });\n\n  $('#forcedelete').on('click', function(){\n    var choice = confirm(\"Are you sure? This will permanently remove all related records. You cannot undo this action.\");\n\t\tif(choice === true){\n      $('#spin').removeClass('hide-spin');\n      var data = {\n        id: $('#id').val(),\n      };\n      var url = \"/admin/forcedeleteadvisor\"\n      $.ajax({\n        method: \"POST\",\n        url: url,\n        data: data\n      })\n      .success(function( message ) {\n        $(location).attr('href', '/admin/advisors');\n      })\n      .fail(function( jqXHR, message ){\n        if (jqXHR.status == 422)\n        {\n          site.setFormErrors(jqXHR.responseJSON);\n        }else{\n          alert(\"Unable to delete: \" + jqXHR.responseJSON);\n        }\n        $('#spin').addClass('hide-spin');\n      });\n    }\n  });\n\n  $('#restore').on('click', function(){\n    var choice = confirm(\"Are you sure?\");\n\t\tif(choice === true){\n      $('#spin').removeClass('hide-spin');\n      var data = {\n        id: $('#id').val(),\n      };\n      var url = \"/admin/restoreadvisor\"\n      $.ajax({\n        method: \"POST\",\n        url: url,\n        data: data\n      })\n      .success(function( message ) {\n        $(location).attr('href', '/admin/advisors');\n      })\n      .fail(function( jqXHR, message ){\n        if (jqXHR.status == 422)\n        {\n          site.setFormErrors(jqXHR.responseJSON);\n        }else{\n          alert(\"Unable to delete: \" + jqXHR.responseJSON);\n        }\n        $('#spin').addClass('hide-spin');\n      });\n    }\n  });\n\n  $(document).on('change', '.btn-file :file', function() {\n    var input = $(this),\n        numFiles = input.get(0).files ? input.get(0).files.length : 1,\n        label = input.val().replace(/\\\\/g, '/').replace(/.*\\//, '');\n    input.trigger('fileselect', [numFiles, label]);\n  });\n\n  $('.btn-file :file').on('fileselect', function(event, numFiles, label) {\n\n      var input = $(this).parents('.input-group').find(':text'),\n          log = numFiles > 1 ? numFiles + ' files selected' : label;\n\n      if( input.length ) {\n          input.val(log);\n      } else {\n          if( log ) alert(log);\n      }\n\n  });\n\n});\n"],"sourceRoot":"/source/"}