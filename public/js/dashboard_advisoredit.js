require(["util/site","util/dashboard"],function(e,a){e.ajaxcrsf();var s=a.dataTableOptions;s.dom='<"newbutton">frtip',a.init(s),e.checkMessage(),$("div.newbutton").html('<a type="button" class="btn btn-success" href="/admin/newadvisor">New Advisor</a>'),$("#save").on("click",function(){$("#spin").removeClass("hide-spin");var a=new FormData($("form")[0]);a.append("name",$("#name").val()),a.append("email",$("#email").val()),a.append("office",$("#office").val()),a.append("phone",$("#phone").val()),a.append("notes",$("#notes").val()),a.append("notes",$("#notes").val()),$("#pic").val()&&a.append("pic",$("#pic")[0].files[0]),$("#department").val()>0&&a.append("department",$("#department").val());var s=$("#id").val();if(0==s.length){a.append("eid",$("#eid").val());var n="/admin/newadvisor"}else{a.append("eid",$("#eid").val());var n="/admin/advisors/"+s}$.ajax({method:"POST",url:n,data:a,dataType:"json",processData:!1,contentType:!1}).success(function(a){0==s.length?(e.clearFormErrors(),$("#spin").addClass("hide-spin"),$(location).attr("href",a)):(e.displayMessage(a,"success"),e.clearFormErrors(),$("#spin").addClass("hide-spin"),$.ajax({method:"GET",url:"/profile/pic/"+s}).success(function(e){$("#pictext").val(e),$("#picimg").attr("src",e)}))}).fail(function(a,s){422==a.status?e.setFormErrors(a.responseJSON):alert("Unable to save: "+a.responseJSON),$("#spin").addClass("hide-spin")})}),$("#delete").on("click",function(){var a=confirm("Are you sure?");if(a===!0){$("#spin").removeClass("hide-spin");var s={id:$("#id").val()},n="/admin/deleteadvisor";$.ajax({method:"POST",url:n,data:s}).success(function(e){$(location).attr("href","/admin/advisors")}).fail(function(a,s){422==a.status?e.setFormErrors(a.responseJSON):alert("Unable to delete: "+a.responseJSON),$("#spin").addClass("hide-spin")})}}),$("#forcedelete").on("click",function(){var a=confirm("Are you sure? This will permanently remove all related records. You cannot undo this action.");if(a===!0){$("#spin").removeClass("hide-spin");var s={id:$("#id").val()},n="/admin/forcedeleteadvisor";$.ajax({method:"POST",url:n,data:s}).success(function(e){$(location).attr("href","/admin/advisors")}).fail(function(a,s){422==a.status?e.setFormErrors(a.responseJSON):alert("Unable to delete: "+a.responseJSON),$("#spin").addClass("hide-spin")})}}),$("#restore").on("click",function(){var a=confirm("Are you sure?");if(a===!0){$("#spin").removeClass("hide-spin");var s={id:$("#id").val()},n="/admin/restoreadvisor";$.ajax({method:"POST",url:n,data:s}).success(function(e){$(location).attr("href","/admin/advisors")}).fail(function(a,s){422==a.status?e.setFormErrors(a.responseJSON):alert("Unable to delete: "+a.responseJSON),$("#spin").addClass("hide-spin")})}}),$(document).on("change",".btn-file :file",function(){var e=$(this),a=e.get(0).files?e.get(0).files.length:1,s=e.val().replace(/\\/g,"/").replace(/.*\//,"");e.trigger("fileselect",[a,s])}),$(".btn-file :file").on("fileselect",function(e,a,s){var n=$(this).parents(".input-group").find(":text"),i=a>1?a+" files selected":s;n.length?n.val(i):i&&alert(i)})});